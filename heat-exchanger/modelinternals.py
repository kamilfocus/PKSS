from numpy import matrix
from math import exp


def getdiscreteb(A, B, h):
    a11 = A.item(0)
    a12 = A.item(1)
    a21 = A.item(2)
    a22 = A.item(3)
    b11 = B.item(0)
    b22 = B.item(3)
    bh11 = (2*b11*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2)*(a22**2*exp((a11*h)/2)*exp((a22*h)/2) - 2*a22*exp((h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) - a11*a22*exp((a11*h)/2)*exp((a22*h)/2) + 2*a12*a21*exp((a11*h)/2)*exp((a22*h)/2) + a22*exp((a11*h)/2)*exp((a22*h)/2)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) - a22**2*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) + a22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) + a11*a22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) - 2*a12*a21*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))))/((4*a11*a22 - 4*a12*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))
    bh12 = (2*a12*a21*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/(4*a12*a21**2 - 4*a11*a22*a21) - (4*a12*a21*b22)/(4*a12*a21**2 - 4*a11*a22*a21) + (2*a12*a21*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/(4*a12*a21**2 - 4*a11*a22*a21) + (2*a11*a12*a21*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/((4*a12*a21**2 - 4*a11*a22*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) + (2*a12*a21*a22*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/((4*a12*a21**2 - 4*a11*a22*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) - (2*a11*a12*a21*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/((4*a12*a21**2 - 4*a11*a22*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) - (2*a12*a21*a22*b22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/((4*a12*a21**2 - 4*a11*a22*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))
    bh21 = (a21*b11*(2/(a11 + a22 - (a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) - (2*exp((a11*h)/2)*exp((a22*h)/2)*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2))/(a11 + a22 - (a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))))/(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) + (2*a21*b11*(exp((a11*h)/2)*exp((a22*h)/2)*exp((h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2) - 1))/((a11 + a22 + (a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))
    bh22 = (2*b22*exp(-(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2)*(a11**2*exp((a11*h)/2)*exp((a22*h)/2) - 2*a11*exp((h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))/2)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) - a11*a22*exp((a11*h)/2)*exp((a22*h)/2) + 2*a12*a21*exp((a11*h)/2)*exp((a22*h)/2) + a11*exp((a11*h)/2)*exp((a22*h)/2)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) - a11**2*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) + a11*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2) + a11*a22*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2)) - 2*a12*a21*exp((a11*h)/2)*exp((a22*h)/2)*exp(h*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))))/((4*a11*a22 - 4*a12*a21)*(a11**2 - 2*a11*a22 + a22**2 + 4*a12*a21)**(1/2))

    return matrix([[bh11, bh12], [bh21, bh22]])
